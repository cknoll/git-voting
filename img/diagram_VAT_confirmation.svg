<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="907" height="817" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[
participant user_k
participant S1a
participant S1b
participant S2
participant GR
participant S3
Note over S2: S2: create \n - CT-B-list (len = $n2) \n - CT-C-list (len = $n2) \n |
S2->GR: _\n  _ \n publish \n list of VAT-hashes \n list of corresp. CT-A-hashes \n list of unsorted CT-C-hashes
S2->S3: \n CT-B-list \n CT-C-list
S2->user_k: CT-B (to those who \n published a confirmation)
user_k-->S3 : CT-B (via tor)
S3->S1a : CT-C encrypted block 1 to AEA
S1a->user_k : CT-C encrypted block 1
S3->S1b : CT-C encrypted block 2 to AEA
S1b->user_k : CT-C encrypted block 2
Note over user_k: combine blocks \n decrypt CT-C
user_k-->GR: push commit with \n VAT, CT-A and CT-C

]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="43.34375" y="20" width="78.171875" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="53.34375" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="53.34375">user_k</tspan></text></g><g class="actor"><rect x="43.34375" y="758.4375" width="78.171875" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="53.34375" y="783.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="53.34375">user_k</tspan></text></g><line x1="82.4296875" x2="82.4296875" y1="59" y2="758.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="289.8984375" y="20" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="299.8984375" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="299.8984375">S1a</tspan></text></g><g class="actor"><rect x="289.8984375" y="758.4375" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="299.8984375" y="783.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="299.8984375">S1a</tspan></text></g><line x1="314.3515625" x2="314.3515625" y1="59" y2="758.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="358.8046875" y="20" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="368.8046875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="368.8046875">S1b</tspan></text></g><g class="actor"><rect x="358.8046875" y="758.4375" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="368.8046875" y="783.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="368.8046875">S1b</tspan></text></g><line x1="383.2578125" x2="383.2578125" y1="59" y2="758.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="489.40625" y="20" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="499.40625" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="499.40625">S2</tspan></text></g><g class="actor"><rect x="489.40625" y="758.4375" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="499.40625" y="783.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="499.40625">S2</tspan></text></g><line x1="509.0390625" x2="509.0390625" y1="59" y2="758.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="778.9375" y="20" width="39.640625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="788.9375" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="788.9375">GR</tspan></text></g><g class="actor"><rect x="778.9375" y="758.4375" width="39.640625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="788.9375" y="783.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="788.9375">GR</tspan></text></g><line x1="798.7578125" x2="798.7578125" y1="59" y2="758.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="838.578125" y="20" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="848.578125" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="848.578125">S3</tspan></text></g><g class="actor"><rect x="838.578125" y="758.4375" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="848.578125" y="783.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="848.578125">S3</tspan></text></g><line x1="858.2109375" x2="858.2109375" y1="59" y2="758.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="393.2578125" y="79" width="231.5625" height="86.609375" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="398.2578125" y="99" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="398.2578125">S2: create</tspan><tspan dy="1.2em" x="398.2578125">- CT-B-list (len = $n2)</tspan><tspan dy="1.2em" x="398.2578125">- CT-C-list (len = $n2)</tspan><tspan dy="1.2em" x="398.2578125">|</tspan></text></g><g class="signal"><text x="519.0390625" y="148.109375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="519.0390625">_</tspan><tspan dy="1.2em" x="519.0390625">_</tspan><tspan dy="1.2em" x="519.0390625">publish</tspan><tspan dy="1.2em" x="519.0390625">list of VAT-hashes</tspan><tspan dy="1.2em" x="519.0390625">list of corresp. CT-A-hashes</tspan><tspan dy="1.2em" x="519.0390625">list of unsorted CT-C-hashes</tspan></text><line x1="509.0390625" x2="798.7578125" y1="300.609375" y2="300.609375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="640.2734375" y="302.3125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="640.2734375"></tspan><tspan dy="1.2em" x="640.2734375">CT-B-list</tspan><tspan dy="1.2em" x="640.2734375">CT-C-list</tspan></text><line x1="509.0390625" x2="858.2109375" y1="358.828125" y2="358.828125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="175.3203125" y="379.7265625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="175.3203125">CT-B (to those who</tspan><tspan dy="1.2em" x="175.3203125">published a confirmation)</tspan></text><line x1="509.0390625" x2="82.4296875" y1="417.03125" y2="417.03125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="402.890625" y="447.53125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="402.890625">CT-B (via tor)</tspan></text><line x1="82.4296875" x2="858.2109375" y1="456.03125" y2="456.03125" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="446.421875" y="486.53125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="446.421875">CT-C encrypted block 1 to AEA</tspan></text><line x1="858.2109375" x2="314.3515625" y1="495.03125" y2="495.03125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="92.4296875" y="525.53125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="92.4296875">CT-C encrypted block 1</tspan></text><line x1="314.3515625" x2="82.4296875" y1="534.03125" y2="534.03125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="480.875" y="564.53125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="480.875">CT-C encrypted block 2 to AEA</tspan></text><line x1="858.2109375" x2="383.2578125" y1="573.03125" y2="573.03125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="126.8828125" y="603.53125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="126.8828125">CT-C encrypted block 2</tspan></text><line x1="383.2578125" x2="82.4296875" y1="612.03125" y2="612.03125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="10" y="632.03125" width="144.859375" height="48.203125" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="652.03125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">combine blocks</tspan><tspan dy="1.2em" x="15">decrypt CT-C</tspan></text></g><g class="signal"><text x="353.8984375" y="701.1328125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="353.8984375">push commit with</tspan><tspan dy="1.2em" x="353.8984375">VAT, CT-A and CT-C</tspan></text><line x1="82.4296875" x2="798.7578125" y1="738.4375" y2="738.4375" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>