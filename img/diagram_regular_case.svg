<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1272" height="1593" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[
participant user_k
participant S1a
participant S1b
participant S2
participant GR
participant S3
Note over S1a: create \n - random  mail fwd \n (AEA-list1) \n - pVAT-list-1a
S1a->S2: (AEA-list1a) \n pVAT-list-1a
Note over S1b: S1b: create \n - random  mail fwd \n (AEA-list2) \n - pVAT-list-1b
S1b->S2: \n (AEA-list1b) \n pVAT-list-1b
Note over S2: S2: create \n - pVAT-list2 \n - VAT-list \n (from all pVATs) \n - CT-A-list
S2->S1a: \n VAT + CT-A (encrypted) \n (block1) to AEA
S1a->user_k: \n VAT + CT-A (encrypted) \n (block1) (fwd)
S2->S1b: \n VAT + CT-A (encrypted) \n (block1) to AEA
S1b->user_k: \n VAT + CT-A (encrypted) \n (block1) (fwd)
Note over user_k: - combine blocks \n - decrypt VAT + CT-A
user_k-->GR: push vote-commit \n to incoming branch via tor
S1a->GR: confirm valid pVAT-1a (via push)
S1b->GR: \n confirm valid pVAT-1b (via push)
S2->GR: \n confirm valid pVAT-2 (via push)
Note over GR: - Check that {S1a, S1b, S2} \n confirmed pVAT \n - push vote commit \n to main branch
GR->user_k: \n update local_repo
Note over user_k: - Check that \n vote is correctly \n represented \n - wait random time \n interval
user_k->GR: \n push confirmation-commit \n (signed with official key) \n to incomming
Note over GR: GR: \n formally check commit \n (prevent spam) \n push to main main branch
Note over S3: not needed \n in regular case

]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="72.4296875" y="20" width="78.171875" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="82.4296875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.4296875">user_k</tspan></text></g><g class="actor"><rect x="72.4296875" y="1534.4375" width="78.171875" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="82.4296875" y="1559.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.4296875">user_k</tspan></text></g><line x1="111.515625" x2="111.515625" y1="59" y2="1534.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="318.984375" y="20" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="328.984375" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="328.984375">S1a</tspan></text></g><g class="actor"><rect x="318.984375" y="1534.4375" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="328.984375" y="1559.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="328.984375">S1a</tspan></text></g><line x1="343.4375" x2="343.4375" y1="59" y2="1534.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="415.8671875" y="20" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="425.8671875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="425.8671875">S1b</tspan></text></g><g class="actor"><rect x="415.8671875" y="1534.4375" width="48.90625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="425.8671875" y="1559.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="425.8671875">S1b</tspan></text></g><line x1="440.3203125" x2="440.3203125" y1="59" y2="1534.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="652.609375" y="20" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="662.609375" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="662.609375">S2</tspan></text></g><g class="actor"><rect x="652.609375" y="1534.4375" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="662.609375" y="1559.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="662.609375">S2</tspan></text></g><line x1="672.2421875" x2="672.2421875" y1="59" y2="1534.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="971.046875" y="20" width="39.640625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="981.046875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="981.046875">GR</tspan></text></g><g class="actor"><rect x="971.046875" y="1534.4375" width="39.640625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="981.046875" y="1559.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="981.046875">GR</tspan></text></g><line x1="990.8671875" x2="990.8671875" y1="59" y2="1534.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1116.28125" y="20" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1126.28125" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1126.28125">S3</tspan></text></g><g class="actor"><rect x="1116.28125" y="1534.4375" width="39.265625" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1126.28125" y="1559.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1126.28125">S3</tspan></text></g><line x1="1135.9140625" x2="1135.9140625" y1="59" y2="1534.4375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="256.5546875" y="79" width="173.765625" height="86.609375" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="261.5546875" y="99" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="261.5546875">create</tspan><tspan dy="1.2em" x="261.5546875">- random  mail fwd</tspan><tspan dy="1.2em" x="261.5546875">(AEA-list1)</tspan><tspan dy="1.2em" x="261.5546875">- pVAT-list-1a</tspan></text></g><g class="signal"><text x="450.04296875" y="186.5078125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="450.04296875">(AEA-list1a)</tspan><tspan dy="1.2em" x="450.04296875">pVAT-list-1a</tspan></text><line x1="343.4375" x2="672.2421875" y1="223.8125" y2="223.8125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="353.4375" y="243.8125" width="173.765625" height="86.609375" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="358.4375" y="263.8125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="358.4375">S1b: create</tspan><tspan dy="1.2em" x="358.4375">- random  mail fwd</tspan><tspan dy="1.2em" x="358.4375">(AEA-list2)</tspan><tspan dy="1.2em" x="358.4375">- pVAT-list-1b</tspan></text></g><g class="signal"><text x="498.484375" y="332.125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="498.484375"></tspan><tspan dy="1.2em" x="498.484375">(AEA-list1b)</tspan><tspan dy="1.2em" x="498.484375">pVAT-list-1b</tspan></text><line x1="440.3203125" x2="672.2421875" y1="388.640625" y2="388.640625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="590.1796875" y="408.640625" width="164.125" height="105.8125" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="595.1796875" y="428.640625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="595.1796875">S2: create</tspan><tspan dy="1.2em" x="595.1796875">- pVAT-list2</tspan><tspan dy="1.2em" x="595.1796875">- VAT-list</tspan><tspan dy="1.2em" x="595.1796875">(from all pVATs)</tspan><tspan dy="1.2em" x="595.1796875">- CT-A-list</tspan></text></g><g class="signal"><text x="401.87890625" y="516.15625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="401.87890625"></tspan><tspan dy="1.2em" x="401.87890625">VAT + CT-A (encrypted)</tspan><tspan dy="1.2em" x="401.87890625">(block1) to AEA</tspan></text><line x1="672.2421875" x2="343.4375" y1="572.671875" y2="572.671875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="121.515625" y="574.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="121.515625"></tspan><tspan dy="1.2em" x="121.515625">VAT + CT-A (encrypted)</tspan><tspan dy="1.2em" x="121.515625">(block1) (fwd)</tspan></text><line x1="343.4375" x2="111.515625" y1="630.890625" y2="630.890625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="450.3203125" y="632.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="450.3203125"></tspan><tspan dy="1.2em" x="450.3203125">VAT + CT-A (encrypted)</tspan><tspan dy="1.2em" x="450.3203125">(block1) to AEA</tspan></text><line x1="672.2421875" x2="440.3203125" y1="689.109375" y2="689.109375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="169.95703125" y="690.8125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="169.95703125"></tspan><tspan dy="1.2em" x="169.95703125">VAT + CT-A (encrypted)</tspan><tspan dy="1.2em" x="169.95703125">(block1) (fwd)</tspan></text><line x1="440.3203125" x2="111.515625" y1="747.328125" y2="747.328125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="10" y="767.328125" width="203.03125" height="48.203125" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="787.328125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">- combine blocks</tspan><tspan dy="1.2em" x="15">- decrypt VAT + CT-A</tspan></text></g><g class="signal"><text x="425.77734375" y="836.4296875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="425.77734375">push vote-commit</tspan><tspan dy="1.2em" x="425.77734375">to incoming branch via tor</tspan></text><line x1="111.515625" x2="990.8671875" y1="873.734375" y2="873.734375" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="513.02734375" y="904.234375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="513.02734375">confirm valid pVAT-1a (via push)</tspan></text><line x1="343.4375" x2="990.8671875" y1="912.734375" y2="912.734375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="561.46875" y="924.0390625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="561.46875"></tspan><tspan dy="1.2em" x="561.46875">confirm valid pVAT-1b (via push)</tspan></text><line x1="440.3203125" x2="990.8671875" y1="951.75" y2="951.75" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="682.2421875" y="963.0546875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="682.2421875"></tspan><tspan dy="1.2em" x="682.2421875">confirm valid pVAT-2 (via push)</tspan></text><line x1="672.2421875" x2="990.8671875" y1="990.765625" y2="990.765625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="855.8203125" y="1010.765625" width="270.09375" height="86.609375" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="860.8203125" y="1030.765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="860.8203125">- Check that {S1a, S1b, S2}</tspan><tspan dy="1.2em" x="860.8203125">confirmed pVAT</tspan><tspan dy="1.2em" x="860.8203125">- push vote commit</tspan><tspan dy="1.2em" x="860.8203125">to main branch</tspan></text></g><g class="signal"><text x="469.30859375" y="1108.6796875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="469.30859375"></tspan><tspan dy="1.2em" x="469.30859375">update local_repo</tspan></text><line x1="990.8671875" x2="111.515625" y1="1136.390625" y2="1136.390625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="19.8203125" y="1156.390625" width="183.390625" height="105.8125" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="24.8203125" y="1176.390625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="24.8203125">- Check that</tspan><tspan dy="1.2em" x="24.8203125">vote is correctly</tspan><tspan dy="1.2em" x="24.8203125">represented</tspan><tspan dy="1.2em" x="24.8203125">- wait random time</tspan><tspan dy="1.2em" x="24.8203125">interval</tspan></text></g><g class="signal"><text x="425.96484375" y="1254.3046875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="425.96484375"></tspan><tspan dy="1.2em" x="425.96484375">push confirmation-commit</tspan><tspan dy="1.2em" x="425.96484375">(signed with official key)</tspan><tspan dy="1.2em" x="425.96484375">to incomming</tspan></text><line x1="111.515625" x2="990.8671875" y1="1339.625" y2="1339.625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="870.2734375" y="1359.625" width="241.1875" height="86.609375" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="875.2734375" y="1379.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="875.2734375">GR:</tspan><tspan dy="1.2em" x="875.2734375">formally check commit</tspan><tspan dy="1.2em" x="875.2734375">(prevent spam)</tspan><tspan dy="1.2em" x="875.2734375">push to main main branch</tspan></text></g><g class="note"><rect x="1058.6640625" y="1466.234375" width="154.5" height="48.203125" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1063.6640625" y="1486.234375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1063.6640625">not needed</tspan><tspan dy="1.2em" x="1063.6640625">in regular case</tspan></text></g></svg>